{"ast":null,"code":"!function (t, e) {\n  \"object\" == typeof exports && \"object\" == typeof module ? module.exports = e() : \"function\" == typeof define && define.amd ? define([], e) : \"object\" == typeof exports ? exports.Midi = e() : t.Midi = e();\n}(window, function () {\n  return function (t) {\n    var e = {};\n\n    function r(n) {\n      if (e[n]) return e[n].exports;\n      var i = e[n] = {\n        i: n,\n        l: !1,\n        exports: {}\n      };\n      return t[n].call(i.exports, i, i.exports, r), i.l = !0, i.exports;\n    }\n\n    return r.m = t, r.c = e, r.d = function (t, e, n) {\n      r.o(t, e) || Object.defineProperty(t, e, {\n        enumerable: !0,\n        get: n\n      });\n    }, r.r = function (t) {\n      \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, {\n        value: \"Module\"\n      }), Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      });\n    }, r.t = function (t, e) {\n      if (1 & e && (t = r(t)), 8 & e) return t;\n      if (4 & e && \"object\" == typeof t && t && t.__esModule) return t;\n      var n = Object.create(null);\n      if (r.r(n), Object.defineProperty(n, \"default\", {\n        enumerable: !0,\n        value: t\n      }), 2 & e && \"string\" != typeof t) for (var i in t) {\n        r.d(n, i, function (e) {\n          return t[e];\n        }.bind(null, i));\n      }\n      return n;\n    }, r.n = function (t) {\n      var e = t && t.__esModule ? function () {\n        return t.default;\n      } : function () {\n        return t;\n      };\n      return r.d(e, \"a\", e), e;\n    }, r.o = function (t, e) {\n      return Object.prototype.hasOwnProperty.call(t, e);\n    }, r.p = \"\", r(r.s = 1);\n  }([function (t, e, r) {\n    var n, i, a;\n    i = [e, r(2), r(1)], void 0 === (a = \"function\" == typeof (n = function n(t, e, r) {\n      \"use strict\";\n\n      function n(t, e) {\n        for (var r = 0; r < e.length; r++) {\n          var n = e[r];\n          n.enumerable = n.enumerable || !1, n.configurable = !0, \"value\" in n && (n.writable = !0), Object.defineProperty(t, n.key, n);\n        }\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.Header = void 0;\n\n      var i = new WeakMap(),\n          a = function () {\n        function t(e) {\n          var r = this;\n          !function (t, e) {\n            if (!(t instanceof e)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, t), i.set(this, 480), this.tempos = [], this.timeSignatures = [], this.name = \"\", this.meta = [], e && (i.set(this, e.header.ticksPerBeat), e.tracks[0].forEach(function (t) {\n            t.meta && (\"timeSignature\" === t.type ? r.timeSignatures.push({\n              ticks: t.absoluteTime,\n              timeSignature: [t.numerator, t.denominator]\n            }) : \"setTempo\" === t.type ? r.tempos.push({\n              ticks: t.absoluteTime,\n              bpm: 6e7 / t.microsecondsPerBeat\n            }) : \"trackName\" === t.type ? r.name = t.text : \"endOfTrack\" !== t.type && r.meta.push({\n              type: t.type,\n              text: t.text,\n              ticks: t.absoluteTime\n            }));\n          }), this.update());\n        }\n\n        return r = t, (a = [{\n          key: \"update\",\n          value: function value() {\n            var t = this,\n                e = 0,\n                r = 0;\n            this.tempos.sort(function (t, e) {\n              return t.ticks - e.ticks;\n            }), this.tempos.forEach(function (n, i) {\n              var a = i > 0 ? t.tempos[i - 1].bpm : t.tempos[0].bpm,\n                  o = n.ticks / t.ppq - r,\n                  s = 60 / a * o;\n              n.time = s + e, e = n.time, r += o;\n            }), this.timeSignatures.sort(function (t, e) {\n              return t.ticks - e.ticks;\n            }), this.timeSignatures.forEach(function (e, r) {\n              var n = r > 0 ? t.timeSignatures[r - 1] : t.timeSignatures[0],\n                  i = (e.ticks - n.ticks) / t.ppq,\n                  a = i / n.timeSignature[0] / (n.timeSignature[1] / 4);\n              n.measures = n.measures || 0, e.measures = a + n.measures;\n            });\n          }\n        }, {\n          key: \"ticksToSeconds\",\n          value: function value(t) {\n            var r = (0, e.search)(this.tempos, t);\n\n            if (-1 !== r) {\n              var n = this.tempos[r],\n                  i = n.time,\n                  a = (t - n.ticks) / this.ppq;\n              return i + 60 / n.bpm * a;\n            }\n\n            var o = t / this.ppq;\n            return .5 * o;\n          }\n        }, {\n          key: \"ticksToMeasures\",\n          value: function value(t) {\n            var r = (0, e.search)(this.timeSignatures, t);\n\n            if (-1 !== r) {\n              var n = this.timeSignatures[r],\n                  i = (t - n.ticks) / this.ppq;\n              return n.measures + i / (n.timeSignature[0] / n.timeSignature[1]) / 4;\n            }\n\n            return t / this.ppq / 4;\n          }\n        }, {\n          key: \"secondsToTicks\",\n          value: function value(t) {\n            var r = (0, e.search)(this.tempos, t, \"time\");\n\n            if (-1 !== r) {\n              var n = this.tempos[r],\n                  i = n.time,\n                  a = t - i,\n                  o = a / (60 / n.bpm);\n              return Math.round(n.ticks + o * this.ppq);\n            }\n\n            var s = t / .5;\n            return Math.round(s * this.ppq);\n          }\n        }, {\n          key: \"toJSON\",\n          value: function value() {\n            return {\n              name: this.name,\n              ppq: this.ppq,\n              meta: this.meta,\n              tempos: this.tempos.map(function (t) {\n                return {\n                  ticks: t.ticks,\n                  bpm: t.bpm\n                };\n              }),\n              timeSignatures: this.timeSignatures\n            };\n          }\n        }, {\n          key: \"fromJSON\",\n          value: function value(t) {\n            this.name = t.name, this.tempos = t.tempos.map(function (t) {\n              return Object.assign({}, t);\n            }), this.timeSignatures = t.timeSignatures.map(function (t) {\n              return Object.assign({}, t);\n            }), this.meta = t.meta.map(function (t) {\n              return Object.assign({}, t);\n            }), i.set(this, t.ppq), this.update();\n          }\n        }, {\n          key: \"ppq\",\n          get: function get() {\n            return i.get(this);\n          }\n        }]) && n(r.prototype, a), o && n(r, o), t;\n        var r, a, o;\n      }();\n\n      t.Header = a;\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e, r) {\n    var n, i, a;\n    i = [e, r(3), r(0), r(4), r(12)], void 0 === (a = \"function\" == typeof (n = function n(t, e, r, _n, i) {\n      \"use strict\";\n\n      function a(t) {\n        return function (t) {\n          if (Array.isArray(t)) {\n            for (var e = 0, r = new Array(t.length); e < t.length; e++) {\n              r[e] = t[e];\n            }\n\n            return r;\n          }\n        }(t) || function (t) {\n          if (Symbol.iterator in Object(t) || \"[object Arguments]\" === Object.prototype.toString.call(t)) return Array.from(t);\n        }(t) || function () {\n          throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n        }();\n      }\n\n      function o(t, e) {\n        for (var r = 0; r < e.length; r++) {\n          var n = e[r];\n          n.enumerable = n.enumerable || !1, n.configurable = !0, \"value\" in n && (n.writable = !0), Object.defineProperty(t, n.key, n);\n        }\n      }\n\n      function s(t, e, r) {\n        return e && o(t.prototype, e), r && o(t, r), t;\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.Midi = void 0;\n\n      var c = function () {\n        function t(i) {\n          var a = this;\n          !function (t, e) {\n            if (!(t instanceof e)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, t);\n          var o = null;\n          i && (i instanceof ArrayBuffer && (i = new Uint8Array(i)), (o = (0, e.parseMidi)(i)).tracks.forEach(function (t) {\n            var e = 0;\n            t.forEach(function (t) {\n              e += t.deltaTime, t.absoluteTime = e;\n            });\n          })), this.header = new r.Header(o), this.tracks = [], i && (this.tracks = o.tracks.map(function (t) {\n            return new _n.Track(t, a.header);\n          }), 1 === o.header.format && 0 === this.tracks[0].duration && this.tracks.shift());\n        }\n\n        return s(t, null, [{\n          key: \"fromUrl\",\n          value: function value(e) {\n            return fetch(e).then(function (t) {\n              if (t.ok) return t.arrayBuffer();\n              throw new Error(\"could not load \".concat(e));\n            }).then(function (e) {\n              return new t(e);\n            });\n          }\n        }]), s(t, [{\n          key: \"addTrack\",\n          value: function value() {\n            var t = new _n.Track(void 0, this.header);\n            return this.tracks.push(t), t;\n          }\n        }, {\n          key: \"toArray\",\n          value: function value() {\n            return (0, i.encode)(this);\n          }\n        }, {\n          key: \"toJSON\",\n          value: function value() {\n            return {\n              header: this.header.toJSON(),\n              tracks: this.tracks.map(function (t) {\n                return t.toJSON();\n              })\n            };\n          }\n        }, {\n          key: \"fromJSON\",\n          value: function value(t) {\n            var e = this;\n            this.header = new r.Header(), this.header.fromJSON(t.header), this.tracks = t.tracks.map(function (t) {\n              var r = new _n.Track(void 0, e.header);\n              return r.fromJSON(t), r;\n            });\n          }\n        }, {\n          key: \"clone\",\n          value: function value() {\n            var e = new t();\n            return e.fromJSON(this.toJSON()), e;\n          }\n        }, {\n          key: \"name\",\n          get: function get() {\n            return this.header.name;\n          },\n          set: function set(t) {\n            this.header.name = t;\n          }\n        }, {\n          key: \"duration\",\n          get: function get() {\n            var t = this.tracks.map(function (t) {\n              return t.duration;\n            });\n            return Math.max.apply(Math, a(t));\n          }\n        }, {\n          key: \"durationTicks\",\n          get: function get() {\n            var t = this.tracks.map(function (t) {\n              return t.durationTicks;\n            });\n            return Math.max.apply(Math, a(t));\n          }\n        }]), t;\n      }();\n\n      t.Midi = c;\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e, r) {\n    var n, i, a;\n    i = [e], void 0 === (a = \"function\" == typeof (n = function n(t) {\n      \"use strict\";\n\n      function e(t, e) {\n        var r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : \"ticks\",\n            n = 0,\n            i = t.length,\n            a = i;\n        if (i > 0 && t[i - 1][r] <= e) return i - 1;\n\n        for (; n < a;) {\n          var o = Math.floor(n + (a - n) / 2),\n              s = t[o],\n              c = t[o + 1];\n\n          if (s[r] === e) {\n            for (var u = o; u < t.length; u++) {\n              var f = t[u];\n              f[r] === e && (o = u);\n            }\n\n            return o;\n          }\n\n          if (s[r] < e && c[r] > e) return o;\n          s[r] > e ? a = o : s[r] < e && (n = o + 1);\n        }\n\n        return -1;\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.insert = function (t, r) {\n        var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : \"ticks\";\n\n        if (t.length) {\n          var i = e(t, r[n], n);\n          t.splice(i + 1, 0, r);\n        } else t.push(r);\n      }, t.search = e;\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e, r) {\n    e.parseMidi = r(6), e.writeMidi = r(7);\n  }, function (t, e, r) {\n    var n, i, a;\n    i = [e, r(8), r(5), r(2), r(9), r(11), r(0)], void 0 === (a = \"function\" == typeof (n = function n(t, e, r, _n2, i, a, o) {\n      \"use strict\";\n\n      function s(t, e) {\n        for (var r = 0; r < e.length; r++) {\n          var n = e[r];\n          n.enumerable = n.enumerable || !1, n.configurable = !0, \"value\" in n && (n.writable = !0), Object.defineProperty(t, n.key, n);\n        }\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.Track = void 0;\n\n      var c = new WeakMap(),\n          u = function () {\n        function t(e, r) {\n          var n = this;\n\n          if (function (t, e) {\n            if (!(t instanceof e)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, t), c.set(this, r), this.name = \"\", e) {\n            var o = e.find(function (t) {\n              return \"trackName\" === t.type;\n            });\n            this.name = o ? o.text : \"\";\n          }\n\n          if (this.instrument = new i.Instrument(e, this), this.notes = [], this.channel = 0, this.controlChanges = (0, a.ControlChanges)(), e) {\n            for (var s = e.filter(function (t) {\n              return \"noteOn\" === t.type;\n            }), u = e.filter(function (t) {\n              return \"noteOff\" === t.type;\n            }), f = function f() {\n              var t = s.shift(),\n                  e = u.findIndex(function (e) {\n                return e.noteNumber === t.noteNumber;\n              });\n\n              if (-1 !== e) {\n                var r = u.splice(e, 1)[0];\n                n.addNote({\n                  midi: t.noteNumber,\n                  ticks: t.absoluteTime,\n                  velocity: t.velocity / 127,\n                  durationTicks: r.absoluteTime - t.absoluteTime,\n                  noteOffVelocity: r.velocity / 127\n                });\n              }\n            }; s.length;) {\n              f();\n            }\n\n            var h = e.filter(function (t) {\n              return \"controller\" === t.type;\n            });\n            h.forEach(function (t) {\n              n.addCC({\n                number: t.controllerType,\n                value: t.value / 127,\n                ticks: t.absoluteTime\n              });\n            });\n          }\n        }\n\n        return o = t, (u = [{\n          key: \"addNote\",\n          value: function value() {\n            var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},\n                r = c.get(this),\n                i = new e.Note({\n              midi: 0,\n              ticks: 0,\n              velocity: 1\n            }, {\n              ticks: 0,\n              velocity: 0\n            }, r);\n            return Object.assign(i, t), (0, _n2.insert)(this.notes, i, \"ticks\"), this;\n          }\n        }, {\n          key: \"addCC\",\n          value: function value(t) {\n            var e = c.get(this),\n                i = new r.ControlChange({\n              controllerType: t.number\n            }, e);\n            return delete t.number, Object.assign(i, t), Array.isArray(this.controlChanges[i.number]) || (this.controlChanges[i.number] = []), (0, _n2.insert)(this.controlChanges[i.number], i, \"ticks\"), this;\n          }\n        }, {\n          key: \"fromJSON\",\n          value: function value(t) {\n            var e = this;\n\n            for (var r in this.name = t.name, this.channel = t.channel, this.instrument = new i.Instrument(void 0, this), this.instrument.fromJSON(t.instrument), t.controlChanges) {\n              t.controlChanges[r].forEach(function (t) {\n                e.addCC({\n                  number: t.number,\n                  value: t.value,\n                  ticks: t.ticks\n                });\n              });\n            }\n\n            t.notes.forEach(function (t) {\n              e.addNote({\n                ticks: t.ticks,\n                durationTicks: t.durationTicks,\n                velocity: t.velocity,\n                midi: t.midi\n              });\n            });\n          }\n        }, {\n          key: \"toJSON\",\n          value: function value() {\n            for (var t = {}, e = 0; e < 127; e++) {\n              this.controlChanges.hasOwnProperty(e) && (t[e] = this.controlChanges[e].map(function (t) {\n                return t.toJSON();\n              }));\n            }\n\n            return {\n              name: this.name,\n              channel: this.channel,\n              instrument: this.instrument.toJSON(),\n              notes: this.notes.map(function (t) {\n                return t.toJSON();\n              }),\n              controlChanges: t\n            };\n          }\n        }, {\n          key: \"duration\",\n          get: function get() {\n            var t = this.notes[this.notes.length - 1];\n            return t ? t.time + t.duration : 0;\n          }\n        }, {\n          key: \"durationTicks\",\n          get: function get() {\n            var t = this.notes[this.notes.length - 1];\n            return t ? t.ticks + t.durationTicks : 0;\n          }\n        }]) && s(o.prototype, u), f && s(o, f), t;\n        var o, u, f;\n      }();\n\n      t.Track = u;\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e, r) {\n    var n, i, a;\n    i = [e, r(0)], void 0 === (a = \"function\" == typeof (n = function n(t, e) {\n      \"use strict\";\n\n      function r(t, e) {\n        for (var r = 0; r < e.length; r++) {\n          var n = e[r];\n          n.enumerable = n.enumerable || !1, n.configurable = !0, \"value\" in n && (n.writable = !0), Object.defineProperty(t, n.key, n);\n        }\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.ControlChange = t.controlChangeIds = t.controlChangeNames = void 0;\n      var n = {\n        1: \"modulationWheel\",\n        2: \"breath\",\n        4: \"footController\",\n        5: \"portamentoTime\",\n        7: \"volume\",\n        8: \"balance\",\n        10: \"pan\",\n        64: \"sustain\",\n        65: \"portamentoTime\",\n        66: \"sostenuto\",\n        67: \"softPedal\",\n        68: \"legatoFootswitch\",\n        84: \"portamentoControl\"\n      };\n      t.controlChangeNames = n;\n      var i = Object.keys(n).reduce(function (t, e) {\n        return t[n[e]] = e, t;\n      }, {});\n      t.controlChangeIds = i;\n\n      var a = new WeakMap(),\n          o = new WeakMap(),\n          s = function () {\n        function t(e, r) {\n          !function (t, e) {\n            if (!(t instanceof e)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, t), a.set(this, r), o.set(this, e.controllerType), this.ticks = e.absoluteTime, this.value = e.value;\n        }\n\n        return e = t, (i = [{\n          key: \"toJSON\",\n          value: function value() {\n            return {\n              number: this.number,\n              value: this.value,\n              time: this.time,\n              ticks: this.ticks\n            };\n          }\n        }, {\n          key: \"number\",\n          get: function get() {\n            return o.get(this);\n          }\n        }, {\n          key: \"name\",\n          get: function get() {\n            return n[this.number] ? n[this.number] : null;\n          }\n        }, {\n          key: \"time\",\n          get: function get() {\n            var t = a.get(this);\n            return t.ticksToSeconds(this.ticks);\n          },\n          set: function set(t) {\n            var e = a.get(this);\n            this.ticks = e.secondsToTicks(t);\n          }\n        }]) && r(e.prototype, i), s && r(e, s), t;\n        var e, i, s;\n      }();\n\n      t.ControlChange = s;\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e) {\n    function r(t) {\n      for (var e, r = new n(t), i = []; !r.eof();) {\n        var a = o();\n        i.push(a);\n      }\n\n      return i;\n\n      function o() {\n        var t = {};\n        t.deltaTime = r.readVarInt();\n        var n = r.readUInt8();\n\n        if (240 == (240 & n)) {\n          if (255 !== n) {\n            if (240 == n) {\n              t.type = \"sysEx\";\n              a = r.readVarInt();\n              return t.data = r.readBytes(a), t;\n            }\n\n            if (247 == n) {\n              t.type = \"endSysEx\";\n              a = r.readVarInt();\n              return t.data = r.readBytes(a), t;\n            }\n\n            throw \"Unrecognised MIDI event type byte: \" + n;\n          }\n\n          t.meta = !0;\n          var i = r.readUInt8(),\n              a = r.readVarInt();\n\n          switch (i) {\n            case 0:\n              if (t.type = \"sequenceNumber\", 2 !== a) throw \"Expected length for sequenceNumber event is 2, got \" + a;\n              return t.number = stream.readUInt16(), t;\n\n            case 1:\n              return t.type = \"text\", t.text = r.readString(a), t;\n\n            case 2:\n              return t.type = \"copyrightNotice\", t.text = r.readString(a), t;\n\n            case 3:\n              return t.type = \"trackName\", t.text = r.readString(a), t;\n\n            case 4:\n              return t.type = \"instrumentName\", t.text = r.readString(a), t;\n\n            case 5:\n              return t.type = \"lyrics\", t.text = r.readString(a), t;\n\n            case 6:\n              return t.type = \"marker\", t.text = r.readString(a), t;\n\n            case 7:\n              return t.type = \"cuePoint\", t.text = r.readString(a), t;\n\n            case 32:\n              if (t.type = \"channelPrefix\", 1 != a) throw \"Expected length for channelPrefix event is 1, got \" + a;\n              return t.channel = r.readUInt8(), t;\n\n            case 33:\n              if (t.type = \"portPrefix\", 1 != a) throw \"Expected length for portPrefix event is 1, got \" + a;\n              return t.port = r.readUInt8(), t;\n\n            case 47:\n              if (t.type = \"endOfTrack\", 0 != a) throw \"Expected length for endOfTrack event is 0, got \" + a;\n              return t;\n\n            case 81:\n              if (t.type = \"setTempo\", 3 != a) throw \"Expected length for setTempo event is 3, got \" + a;\n              return t.microsecondsPerBeat = r.readUInt24(), t;\n\n            case 84:\n              if (t.type = \"smpteOffset\", 5 != a) throw \"Expected length for smpteOffset event is 5, got \" + a;\n              var o = r.readUInt8();\n              return t.frameRate = {\n                0: 24,\n                32: 25,\n                64: 29,\n                96: 30\n              }[96 & o], t.hour = 31 & o, t.min = r.readUInt8(), t.sec = r.readUInt8(), t.frame = r.readUInt8(), t.subFrame = r.readUInt8(), t;\n\n            case 88:\n              if (t.type = \"timeSignature\", 4 != a) throw \"Expected length for timeSignature event is 4, got \" + a;\n              return t.numerator = r.readUInt8(), t.denominator = 1 << r.readUInt8(), t.metronome = r.readUInt8(), t.thirtyseconds = r.readUInt8(), t;\n\n            case 89:\n              if (t.type = \"keySignature\", 2 != a) throw \"Expected length for keySignature event is 2, got \" + a;\n              return t.key = r.readInt8(), t.scale = r.readUInt8(), t;\n\n            case 127:\n              return t.type = \"sequencerSpecific\", t.data = r.readBytes(a), t;\n\n            default:\n              return t.type = \"unknownMeta\", t.data = r.readBytes(a), t.metatypeByte = i, t;\n          }\n        } else {\n          var s;\n\n          if (0 == (128 & n)) {\n            if (null === e) throw \"Running status byte encountered before status byte\";\n            s = n, n = e, t.running = !0;\n          } else s = r.readUInt8(), e = n;\n\n          var c = n >> 4;\n\n          switch (t.channel = 15 & n, c) {\n            case 8:\n              return t.type = \"noteOff\", t.noteNumber = s, t.velocity = r.readUInt8(), t;\n\n            case 9:\n              var u = r.readUInt8();\n              return t.type = 0 === u ? \"noteOff\" : \"noteOn\", t.noteNumber = s, t.velocity = u, 0 === u && (t.byte9 = !0), t;\n\n            case 10:\n              return t.type = \"noteAftertouch\", t.noteNumber = s, t.amount = r.readUInt8(), t;\n\n            case 11:\n              return t.type = \"controller\", t.controllerType = s, t.value = r.readUInt8(), t;\n\n            case 12:\n              return t.type = \"programChange\", t.programNumber = s, t;\n\n            case 13:\n              return t.type = \"channelAftertouch\", t.amount = s, t;\n\n            case 14:\n              return t.type = \"pitchBend\", t.value = s + (r.readUInt8() << 7) - 8192, t;\n\n            default:\n              throw \"Unrecognised MIDI event type: \" + c;\n          }\n        }\n      }\n    }\n\n    function n(t) {\n      this.buffer = t, this.bufferLen = this.buffer.length, this.pos = 0;\n    }\n\n    n.prototype.eof = function () {\n      return this.pos >= this.bufferLen;\n    }, n.prototype.readUInt8 = function () {\n      var t = this.buffer[this.pos];\n      return this.pos += 1, t;\n    }, n.prototype.readInt8 = function () {\n      var t = this.readUInt8();\n      return 128 & t ? t - 256 : t;\n    }, n.prototype.readUInt16 = function () {\n      return (this.readUInt8() << 8) + this.readUInt8();\n    }, n.prototype.readInt16 = function () {\n      var t = this.readUInt16();\n      return 32768 & t ? t - 65536 : t;\n    }, n.prototype.readUInt24 = function () {\n      return (this.readUInt8() << 16) + (this.readUInt8() << 8) + this.readUInt8();\n    }, n.prototype.readInt24 = function () {\n      var t = this.readUInt24();\n      return 8388608 & t ? t - 16777216 : t;\n    }, n.prototype.readUInt32 = function () {\n      return (this.readUInt8() << 24) + (this.readUInt8() << 16) + (this.readUInt8() << 8) + this.readUInt8();\n    }, n.prototype.readBytes = function (t) {\n      var e = this.buffer.slice(this.pos, this.pos + t);\n      return this.pos += t, e;\n    }, n.prototype.readString = function (t) {\n      var e = this.readBytes(t);\n      return String.fromCharCode.apply(null, e);\n    }, n.prototype.readVarInt = function () {\n      for (var t = 0; !this.eof();) {\n        var e = this.readUInt8();\n        if (!(128 & e)) return t + e;\n        t += 127 & e, t <<= 7;\n      }\n\n      return t;\n    }, n.prototype.readChunk = function () {\n      var t = this.readString(4),\n          e = this.readUInt32();\n      return {\n        id: t,\n        length: e,\n        data: this.readBytes(e)\n      };\n    }, t.exports = function (t) {\n      var e = new n(t),\n          i = e.readChunk();\n      if (\"MThd\" != i.id) throw \"Bad MIDI file.  Expected 'MHdr', got: '\" + i.id + \"'\";\n\n      for (var a = function (t) {\n        var e = new n(t),\n            r = e.readUInt16(),\n            i = e.readUInt16(),\n            a = {\n          format: r,\n          numTracks: i\n        },\n            o = e.readUInt16();\n        return 32768 & o ? (a.framesPerSecond = 256 - (o >> 8), a.ticksPerFrame = 255 & o) : a.ticksPerBeat = o, a;\n      }(i.data), o = [], s = 0; !e.eof() && s < a.numTracks; s++) {\n        var c = e.readChunk();\n        if (\"MTrk\" != c.id) throw \"Bad MIDI file.  Expected 'MTrk', got: '\" + c.id + \"'\";\n        var u = r(c.data);\n        o.push(u);\n      }\n\n      return {\n        header: a,\n        tracks: o\n      };\n    };\n  }, function (t, e) {\n    function r(t, e, r) {\n      var a,\n          o = new i(),\n          s = e.length,\n          c = null;\n\n      for (a = 0; a < s; a++) {\n        !1 !== r.running && (r.running || e[a].running) || (c = null), c = n(o, e[a], c, r.useByte9ForNoteOff);\n      }\n\n      t.writeChunk(\"MTrk\", o.buffer);\n    }\n\n    function n(t, e, r, n) {\n      var i = e.type,\n          a = e.deltaTime,\n          o = e.text || \"\",\n          s = e.data || [],\n          c = null;\n\n      switch (t.writeVarInt(a), i) {\n        case \"sequenceNumber\":\n          t.writeUInt8(255), t.writeUInt8(0), t.writeVarInt(2), t.writeUInt16(e.number);\n          break;\n\n        case \"text\":\n          t.writeUInt8(255), t.writeUInt8(1), t.writeVarInt(o.length), t.writeString(o);\n          break;\n\n        case \"copyrightNotice\":\n          t.writeUInt8(255), t.writeUInt8(2), t.writeVarInt(o.length), t.writeString(o);\n          break;\n\n        case \"trackName\":\n          t.writeUInt8(255), t.writeUInt8(3), t.writeVarInt(o.length), t.writeString(o);\n          break;\n\n        case \"instrumentName\":\n          t.writeUInt8(255), t.writeUInt8(4), t.writeVarInt(o.length), t.writeString(o);\n          break;\n\n        case \"lyrics\":\n          t.writeUInt8(255), t.writeUInt8(5), t.writeVarInt(o.length), t.writeString(o);\n          break;\n\n        case \"marker\":\n          t.writeUInt8(255), t.writeUInt8(6), t.writeVarInt(o.length), t.writeString(o);\n          break;\n\n        case \"cuePoint\":\n          t.writeUInt8(255), t.writeUInt8(7), t.writeVarInt(o.length), t.writeString(o);\n          break;\n\n        case \"channelPrefix\":\n          t.writeUInt8(255), t.writeUInt8(32), t.writeVarInt(1), t.writeUInt8(e.channel);\n          break;\n\n        case \"portPrefix\":\n          t.writeUInt8(255), t.writeUInt8(33), t.writeVarInt(1), t.writeUInt8(e.port);\n          break;\n\n        case \"endOfTrack\":\n          t.writeUInt8(255), t.writeUInt8(47), t.writeVarInt(0);\n          break;\n\n        case \"setTempo\":\n          t.writeUInt8(255), t.writeUInt8(81), t.writeVarInt(3), t.writeUInt24(e.microsecondsPerBeat);\n          break;\n\n        case \"smpteOffset\":\n          t.writeUInt8(255), t.writeUInt8(84), t.writeVarInt(5);\n          var u = 31 & e.hour | {\n            24: 0,\n            25: 32,\n            29: 64,\n            30: 96\n          }[e.frameRate];\n          t.writeUInt8(u), t.writeUInt8(e.min), t.writeUInt8(e.sec), t.writeUInt8(e.frame), t.writeUInt8(e.subFrame);\n          break;\n\n        case \"timeSignature\":\n          t.writeUInt8(255), t.writeUInt8(88), t.writeVarInt(4), t.writeUInt8(e.numerator);\n          var f = 255 & Math.floor(Math.log(e.denominator) / Math.LN2);\n          t.writeUInt8(f), t.writeUInt8(e.metronome), t.writeUInt8(e.thirtyseconds || 8);\n          break;\n\n        case \"keySignature\":\n          t.writeUInt8(255), t.writeUInt8(89), t.writeVarInt(2), t.writeInt8(e.key), t.writeUInt8(e.scale);\n          break;\n\n        case \"sequencerSpecific\":\n          t.writeUInt8(255), t.writeUInt8(127), t.writeVarInt(s.length), t.writeBytes(s);\n          break;\n\n        case \"unknownMeta\":\n          null != e.metatypeByte && (t.writeUInt8(255), t.writeUInt8(e.metatypeByte), t.writeVarInt(s.length), t.writeBytes(s));\n          break;\n\n        case \"sysEx\":\n          t.writeUInt8(240), t.writeVarInt(s.length), t.writeBytes(s);\n          break;\n\n        case \"endSysEx\":\n          t.writeUInt8(247), t.writeVarInt(s.length), t.writeBytes(s);\n          break;\n\n        case \"noteOff\":\n          (c = (!1 !== n && e.byte9 || n && 0 == e.velocity ? 144 : 128) | e.channel) !== r && t.writeUInt8(c), t.writeUInt8(e.noteNumber), t.writeUInt8(e.velocity);\n          break;\n\n        case \"noteOn\":\n          (c = 144 | e.channel) !== r && t.writeUInt8(c), t.writeUInt8(e.noteNumber), t.writeUInt8(e.velocity);\n          break;\n\n        case \"noteAftertouch\":\n          (c = 160 | e.channel) !== r && t.writeUInt8(c), t.writeUInt8(e.noteNumber), t.writeUInt8(e.amount);\n          break;\n\n        case \"controller\":\n          (c = 176 | e.channel) !== r && t.writeUInt8(c), t.writeUInt8(e.controllerType), t.writeUInt8(e.value);\n          break;\n\n        case \"programChange\":\n          (c = 192 | e.channel) !== r && t.writeUInt8(c), t.writeUInt8(e.programNumber);\n          break;\n\n        case \"channelAftertouch\":\n          (c = 208 | e.channel) !== r && t.writeUInt8(c), t.writeUInt8(e.amount);\n          break;\n\n        case \"pitchBend\":\n          (c = 224 | e.channel) !== r && t.writeUInt8(c);\n          var h = 8192 + e.value,\n              l = 127 & h,\n              p = h >> 7 & 127;\n          t.writeUInt8(l), t.writeUInt8(p);\n          break;\n\n        default:\n          throw \"Unrecognized event type: \" + i;\n      }\n\n      return c;\n    }\n\n    function i() {\n      this.buffer = [];\n    }\n\n    i.prototype.writeUInt8 = function (t) {\n      this.buffer.push(255 & t);\n    }, i.prototype.writeInt8 = i.prototype.writeUInt8, i.prototype.writeUInt16 = function (t) {\n      var e = t >> 8 & 255,\n          r = 255 & t;\n      this.writeUInt8(e), this.writeUInt8(r);\n    }, i.prototype.writeInt16 = i.prototype.writeUInt16, i.prototype.writeUInt24 = function (t) {\n      var e = t >> 16 & 255,\n          r = t >> 8 & 255,\n          n = 255 & t;\n      this.writeUInt8(e), this.writeUInt8(r), this.writeUInt8(n);\n    }, i.prototype.writeInt24 = i.prototype.writeUInt24, i.prototype.writeUInt32 = function (t) {\n      var e = t >> 24 & 255,\n          r = t >> 16 & 255,\n          n = t >> 8 & 255,\n          i = 255 & t;\n      this.writeUInt8(e), this.writeUInt8(r), this.writeUInt8(n), this.writeUInt8(i);\n    }, i.prototype.writeInt32 = i.prototype.writeUInt32, i.prototype.writeBytes = function (t) {\n      this.buffer = this.buffer.concat(Array.prototype.slice.call(t, 0));\n    }, i.prototype.writeString = function (t) {\n      var e,\n          r = t.length,\n          n = [];\n\n      for (e = 0; e < r; e++) {\n        n.push(t.codePointAt(e));\n      }\n\n      this.writeBytes(n);\n    }, i.prototype.writeVarInt = function (t) {\n      if (t < 0) throw \"Cannot write negative variable-length integer\";\n      if (t <= 127) this.writeUInt8(t);else {\n        var e = t,\n            r = [];\n\n        for (r.push(127 & e), e >>= 7; e;) {\n          var n = 127 & e | 128;\n          r.push(n), e >>= 7;\n        }\n\n        this.writeBytes(r.reverse());\n      }\n    }, i.prototype.writeChunk = function (t, e) {\n      this.writeString(t), this.writeUInt32(e.length), this.writeBytes(e);\n    }, t.exports = function (t, e) {\n      if (\"object\" != typeof t) throw \"Invalid MIDI data\";\n      e = e || {};\n      var n,\n          a = t.header || {},\n          o = t.tracks || [],\n          s = o.length,\n          c = new i();\n\n      for (function (t, e, r) {\n        var n = null == e.format ? 1 : e.format,\n            a = 128;\n        e.timeDivision ? a = e.timeDivision : e.ticksPerFrame && e.framesPerSecond ? a = -(255 & e.framesPerSecond) << 8 | 255 & ticksPerFrame : e.ticksPerBeat && (a = 32767 & e.ticksPerBeat);\n        var o = new i();\n        o.writeUInt16(n), o.writeUInt16(r), o.writeUInt16(a), t.writeChunk(\"MThd\", o.buffer);\n      }(c, a, s), n = 0; n < s; n++) {\n        r(c, o[n], e);\n      }\n\n      return c.buffer;\n    };\n  }, function (t, e, r) {\n    var n, i, a;\n    i = [e, r(0), r(2)], void 0 === (a = \"function\" == typeof (n = function n(t, e, r) {\n      \"use strict\";\n\n      function n(t, e) {\n        for (var r = 0; r < e.length; r++) {\n          var n = e[r];\n          n.enumerable = n.enumerable || !1, n.configurable = !0, \"value\" in n && (n.writable = !0), Object.defineProperty(t, n.key, n);\n        }\n      }\n\n      function i(t) {\n        var e = t % 12;\n        return [\"C\", \"C#\", \"D\", \"D#\", \"E\", \"F\", \"F#\", \"G\", \"G#\", \"A\", \"A#\", \"B\"][e];\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.Note = void 0;\n\n      var a,\n          o,\n          s = (a = /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i, o = {\n        cbb: -2,\n        cb: -1,\n        c: 0,\n        \"c#\": 1,\n        cx: 2,\n        dbb: 0,\n        db: 1,\n        d: 2,\n        \"d#\": 3,\n        dx: 4,\n        ebb: 2,\n        eb: 3,\n        e: 4,\n        \"e#\": 5,\n        ex: 6,\n        fbb: 3,\n        fb: 4,\n        f: 5,\n        \"f#\": 6,\n        fx: 7,\n        gbb: 5,\n        gb: 6,\n        g: 7,\n        \"g#\": 8,\n        gx: 9,\n        abb: 7,\n        ab: 8,\n        a: 9,\n        \"a#\": 10,\n        ax: 11,\n        bbb: 9,\n        bb: 10,\n        b: 11,\n        \"b#\": 12,\n        bx: 13\n      }, function (t) {\n        var e = a.exec(t),\n            r = e[1],\n            n = e[2],\n            i = o[r.toLowerCase()];\n        return i + 12 * (parseInt(n) + 1);\n      }),\n          c = new WeakMap(),\n          u = function () {\n        function t(e, r, n) {\n          !function (t, e) {\n            if (!(t instanceof e)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, t), c.set(this, n), this.midi = e.midi, this.velocity = e.velocity, this.noteOffVelocity = r.velocity, this.ticks = e.ticks, this.durationTicks = r.ticks - e.ticks;\n        }\n\n        return e = t, (r = [{\n          key: \"toJSON\",\n          value: function value() {\n            return {\n              time: this.time,\n              midi: this.midi,\n              name: this.name,\n              velocity: this.velocity,\n              duration: this.duration,\n              ticks: this.ticks,\n              durationTicks: this.durationTicks\n            };\n          }\n        }, {\n          key: \"name\",\n          get: function get() {\n            return t = this.midi, e = Math.floor(t / 12) - 1, i(t) + e.toString();\n            var t, e;\n          },\n          set: function set(t) {\n            this.midi = s(t);\n          }\n        }, {\n          key: \"octave\",\n          get: function get() {\n            return Math.floor(this.midi / 12) - 1;\n          },\n          set: function set(t) {\n            var e = t - this.octave;\n            this.midi += 12 * e;\n          }\n        }, {\n          key: \"pitch\",\n          get: function get() {\n            return i(this.midi);\n          },\n          set: function set(t) {\n            this.midi = 12 * (this.octave + 1) + [\"C\", \"C#\", \"D\", \"D#\", \"E\", \"F\", \"F#\", \"G\", \"G#\", \"A\", \"A#\", \"B\"].indexOf(t);\n          }\n        }, {\n          key: \"duration\",\n          get: function get() {\n            var t = c.get(this);\n            return t.ticksToSeconds(this.ticks + this.durationTicks) - t.ticksToSeconds(this.ticks);\n          },\n          set: function set(t) {\n            var e = c.get(this),\n                r = e.secondsToTicks(this.time + t);\n            this.durationTicks = r - this.ticks;\n          }\n        }, {\n          key: \"time\",\n          get: function get() {\n            var t = c.get(this);\n            return t.ticksToSeconds(this.ticks);\n          },\n          set: function set(t) {\n            var e = c.get(this);\n            this.ticks = e.secondsToTicks(t);\n          }\n        }, {\n          key: \"bars\",\n          get: function get() {\n            var t = c.get(this);\n            return t.ticksToMeasures(this.ticks);\n          }\n        }]) && n(e.prototype, r), a && n(e, a), t;\n        var e, r, a;\n      }();\n\n      t.Note = u;\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e, r) {\n    var n, i, a;\n    i = [e, r(10), r(4)], void 0 === (a = \"function\" == typeof (n = function n(t, e, r) {\n      \"use strict\";\n\n      function n(t, e) {\n        for (var r = 0; r < e.length; r++) {\n          var n = e[r];\n          n.enumerable = n.enumerable || !1, n.configurable = !0, \"value\" in n && (n.writable = !0), Object.defineProperty(t, n.key, n);\n        }\n      }\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.Instrument = void 0;\n\n      var i = new WeakMap(),\n          a = function () {\n        function t(e, r) {\n          if (function (t, e) {\n            if (!(t instanceof e)) throw new TypeError(\"Cannot call a class as a function\");\n          }(this, t), i.set(this, r), this.number = 0, e) {\n            var n = e.find(function (t) {\n              return \"programChange\" === t.type;\n            });\n            n && (this.number = n.programNumber);\n          }\n        }\n\n        return r = t, (a = [{\n          key: \"toJSON\",\n          value: function value() {\n            return {\n              number: this.number,\n              name: this.name,\n              family: this.family\n            };\n          }\n        }, {\n          key: \"fromJSON\",\n          value: function value(t) {\n            this.number = t.number;\n          }\n        }, {\n          key: \"name\",\n          get: function get() {\n            return this.percussion ? e.drumKitByPatchID[this.number] : e.instrumentByPatchID[this.number];\n          },\n          set: function set(t) {\n            var r = e.instrumentByPatchID.indexOf(t);\n            -1 !== r && (this.number = r);\n          }\n        }, {\n          key: \"family\",\n          get: function get() {\n            return this.percussion ? \"drums\" : e.instrumentFamilyByID[Math.floor(this.number / 8)];\n          }\n        }, {\n          key: \"percussion\",\n          get: function get() {\n            var t = i.get(this);\n            return [9, 10].includes(t.channel);\n          }\n        }]) && n(r.prototype, a), o && n(r, o), t;\n        var r, a, o;\n      }();\n\n      t.Instrument = a;\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e, r) {\n    var n, i, a;\n    i = [e], void 0 === (a = \"function\" == typeof (n = function n(t) {\n      \"use strict\";\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.drumKitByPatchID = t.instrumentFamilyByID = t.instrumentByPatchID = void 0, t.instrumentByPatchID = [\"acoustic grand piano\", \"bright acoustic piano\", \"electric grand piano\", \"honky-tonk piano\", \"electric piano 1\", \"electric piano 2\", \"harpsichord\", \"clavi\", \"celesta\", \"glockenspiel\", \"music box\", \"vibraphone\", \"marimba\", \"xylophone\", \"tubular bells\", \"dulcimer\", \"drawbar organ\", \"percussive organ\", \"rock organ\", \"church organ\", \"reed organ\", \"accordion\", \"harmonica\", \"tango accordion\", \"acoustic guitar (nylon)\", \"acoustic guitar (steel)\", \"electric guitar (jazz)\", \"electric guitar (clean)\", \"electric guitar (muted)\", \"overdriven guitar\", \"distortion guitar\", \"guitar harmonics\", \"acoustic bass\", \"electric bass (finger)\", \"electric bass (pick)\", \"fretless bass\", \"slap bass 1\", \"slap bass 2\", \"synth bass 1\", \"synth bass 2\", \"violin\", \"viola\", \"cello\", \"contrabass\", \"tremolo strings\", \"pizzicato strings\", \"orchestral harp\", \"timpani\", \"string ensemble 1\", \"string ensemble 2\", \"synthstrings 1\", \"synthstrings 2\", \"choir aahs\", \"voice oohs\", \"synth voice\", \"orchestra hit\", \"trumpet\", \"trombone\", \"tuba\", \"muted trumpet\", \"french horn\", \"brass section\", \"synthbrass 1\", \"synthbrass 2\", \"soprano sax\", \"alto sax\", \"tenor sax\", \"baritone sax\", \"oboe\", \"english horn\", \"bassoon\", \"clarinet\", \"piccolo\", \"flute\", \"recorder\", \"pan flute\", \"blown bottle\", \"shakuhachi\", \"whistle\", \"ocarina\", \"lead 1 (square)\", \"lead 2 (sawtooth)\", \"lead 3 (calliope)\", \"lead 4 (chiff)\", \"lead 5 (charang)\", \"lead 6 (voice)\", \"lead 7 (fifths)\", \"lead 8 (bass + lead)\", \"pad 1 (new age)\", \"pad 2 (warm)\", \"pad 3 (polysynth)\", \"pad 4 (choir)\", \"pad 5 (bowed)\", \"pad 6 (metallic)\", \"pad 7 (halo)\", \"pad 8 (sweep)\", \"fx 1 (rain)\", \"fx 2 (soundtrack)\", \"fx 3 (crystal)\", \"fx 4 (atmosphere)\", \"fx 5 (brightness)\", \"fx 6 (goblins)\", \"fx 7 (echoes)\", \"fx 8 (sci-fi)\", \"sitar\", \"banjo\", \"shamisen\", \"koto\", \"kalimba\", \"bag pipe\", \"fiddle\", \"shanai\", \"tinkle bell\", \"agogo\", \"steel drums\", \"woodblock\", \"taiko drum\", \"melodic tom\", \"synth drum\", \"reverse cymbal\", \"guitar fret noise\", \"breath noise\", \"seashore\", \"bird tweet\", \"telephone ring\", \"helicopter\", \"applause\", \"gunshot\"], t.instrumentFamilyByID = [\"piano\", \"chromatic percussion\", \"organ\", \"guitar\", \"bass\", \"strings\", \"ensemble\", \"brass\", \"reed\", \"pipe\", \"synth lead\", \"synth pad\", \"synth effects\", \"world\", \"percussive\", \"sound effects\"], t.drumKitByPatchID = {\n        0: \"standard kit\",\n        8: \"room kit\",\n        16: \"power kit\",\n        24: \"electronic kit\",\n        25: \"tr-808 kit\",\n        32: \"jazz kit\",\n        40: \"brush kit\",\n        48: \"orchestra kit\",\n        56: \"sound fx kit\"\n      };\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e, r) {\n    var n, i, a;\n    i = [e, r(5)], void 0 === (a = \"function\" == typeof (n = function n(t, e) {\n      \"use strict\";\n\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.ControlChanges = function () {\n        return new Proxy({}, {\n          get: function get(t, r) {\n            return t[r] ? t[r] : e.controlChangeIds.hasOwnProperty(r) ? t[e.controlChangeIds[r]] : void 0;\n          },\n          set: function set(t, r, n) {\n            return e.controlChangeIds.hasOwnProperty(r) ? t[e.controlChangeIds[r]] = n : t[r] = n, !0;\n          }\n        });\n      };\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e, r) {\n    var n, i, a;\n    i = [e, r(3), r(13), r(1)], void 0 === (a = \"function\" == typeof (n = function n(t, e, r, _n3) {\n      \"use strict\";\n\n      function i(t) {\n        return function (t) {\n          if (Array.isArray(t)) {\n            for (var e = 0, r = new Array(t.length); e < t.length; e++) {\n              r[e] = t[e];\n            }\n\n            return r;\n          }\n        }(t) || function (t) {\n          if (Symbol.iterator in Object(t) || \"[object Arguments]\" === Object.prototype.toString.call(t)) return Array.from(t);\n        }(t) || function () {\n          throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n        }();\n      }\n\n      var a;\n      Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      }), t.encode = function (t) {\n        var n = {\n          header: {\n            ticksPerBeat: t.header.ppq,\n            format: 1,\n            numTracks: t.tracks.length + 1\n          },\n          tracks: [[{\n            ticks: 0,\n            meta: !0,\n            type: \"trackName\",\n            text: t.header.name\n          }].concat(i(t.header.meta.map(function (t) {\n            return {\n              ticks: t.ticks,\n              meta: !0,\n              type: t.type,\n              text: t.text\n            };\n          })), i(t.header.tempos.map(function (t) {\n            return {\n              type: \"setTempo\",\n              microsecondsPerBeat: Math.floor(6e7 / t.bpm),\n              ticks: t.ticks,\n              meta: !0\n            };\n          })), i(t.header.timeSignatures.map(function (t) {\n            return {\n              type: \"timeSignature\",\n              meta: !0,\n              ticks: t.ticks,\n              numerator: t.timeSignature[0],\n              denominator: t.timeSignature[1],\n              metronome: 24,\n              thirtyseconds: 8\n            };\n          })))].concat(i(t.tracks.map(function (t) {\n            for (var e = [], n = 0; n < 127; n++) {\n              t.controlChanges.hasOwnProperty(n) && e.push(t.controlChanges[n].map(function (e) {\n                return {\n                  type: \"controller\",\n                  controllerType: e.number,\n                  value: Math.floor(127 * e.value),\n                  channel: t.channel,\n                  ticks: e.ticks\n                };\n              }));\n            }\n\n            return [{\n              type: \"trackName\",\n              text: t.name,\n              meta: !0,\n              ticks: 0\n            }, {\n              type: \"programChange\",\n              ticks: 0,\n              channel: t.channel,\n              programNumber: t.instrument.number\n            }].concat(i((0, r.default)(t.notes.map(function (e) {\n              return [{\n                type: \"noteOn\",\n                channel: t.channel,\n                noteNumber: e.midi,\n                ticks: e.ticks,\n                velocity: Math.floor(127 * e.velocity)\n              }, {\n                type: \"noteOff\",\n                channel: t.channel,\n                noteNumber: e.midi,\n                ticks: e.ticks + e.durationTicks,\n                velocity: Math.floor(127 * e.noteOffVelocity)\n              }];\n            }))), i((0, r.default)(e)));\n          })))\n        };\n        return n.tracks = n.tracks.map(function (t) {\n          t = t.sort(function (t, e) {\n            return t.ticks - e.ticks;\n          });\n          var e = 0;\n          return t.forEach(function (t) {\n            t.deltaTime = t.ticks - e, e = t.ticks, delete t.ticks;\n          }), t.push({\n            deltaTime: 0,\n            meta: !0,\n            type: \"endOfTrack\"\n          }), t;\n        }), new Uint8Array((0, e.writeMidi)(n));\n      }, r = (a = r) && a.__esModule ? a : {\n        default: a\n      };\n    }) ? n.apply(e, i) : n) || (t.exports = a);\n  }, function (t, e, r) {\n    \"use strict\";\n\n    function n(t) {\n      return function t(e, r) {\n        for (var n = 0; n < e.length; n++) {\n          var i = e[n];\n          Array.isArray(i) ? t(i, r) : r.push(i);\n        }\n\n        return r;\n      }(t, []);\n    }\n\n    function i(t, e) {\n      if (\"number\" != typeof e) throw new TypeError(\"Expected the depth to be a number\");\n      return function t(e, r, n) {\n        n--;\n\n        for (var i = 0; i < e.length; i++) {\n          var a = e[i];\n          n > -1 && Array.isArray(a) ? t(a, r, n) : r.push(a);\n        }\n\n        return r;\n      }(t, [], e);\n    }\n\n    t.exports = function (t) {\n      if (!Array.isArray(t)) throw new TypeError(\"Expected value to be an array\");\n      return n(t);\n    }, t.exports.from = n, t.exports.depth = function (t, e) {\n      if (!Array.isArray(t)) throw new TypeError(\"Expected value to be an array\");\n      return i(t, e);\n    }, t.exports.fromDepth = i;\n  }]).Midi;\n});","map":null,"metadata":{},"sourceType":"script"}